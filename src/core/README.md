# core

## 概述

core 目录提供主业务逻辑：认证初始化、文档加载、用例生成与语义判定。

- `auth_setup.py`: 登录获取 token，写回配置，并替换原始文档中的占位符。
- `doc_parser.py`: 读取并合并接口文档内容。
- `case_generator.py`: 组合全局变量与文档内容，调用 LLM 或 Agentic/RAG 流程生成用例并落盘。
- `ai_judge.py`: 执行断言（精确匹配 / 语义匹配 / LLM 判定）。

## 调用图（txt）

```text
+---------------------------+
|    CaseGenerator.run      |
|  (generate_cases entry)   |
+-------------+-------------+
              |
              V
+---------------------------+
| load_documents            |
| (doc_parser)              |
+-------------+-------------+
              |
              V
+---------------------------+
| format_global_context     |
| (global vars)             |
+-------------+-------------+
              |
              V
+---------------------------+
| RAG enabled?              |
+-------------+-------------+
      | Yes                      | No
      V                          V
+---------------------------+   +---------------------------+
| DocSlicer.slice_text      |   | LLMClient.chat_completion |
+-------------+-------------+   +-------------+-------------+
              |                              |
              V                              V
+---------------------------+   +---------------------------+
| AgentOrchestrator.run     |   | _extract_json/_parse_json |
| (Agentic loop optional)   |   +-------------+-------------+
+-------------+-------------+                 |
              |                               V
              V                     +---------------------------+
+---------------------------+       | _normalize_cases           |
| LLMClient.chat_completion |       +-------------+-------------+
+-------------+-------------+                     |
              |                                   V
              V                         +---------------------------+
+---------------------------+           | write_json (data/test_cases)
| AgentJudge.review         |           +---------------------------+
+---------------------------+

+---------------------------+
| AuthSetup.run              |
| (login + token replace)    |
+-------------+-------------+
              |
              V
+---------------------------+
| requests.post(login_url)  |
+-------------+-------------+
              |
              V
+---------------------------+
| _extract_token + write_yaml|
+-------------+-------------+
              |
              V
+---------------------------+
| _replace_token_in_docs     |
+---------------------------+

+---------------------------+
| AIJudge.verify             |
| (exact/heuristic/LLM)      |
+-------------+-------------+
              |
              V
+---------------------------+
| LLMClient.chat_completion  |
+---------------------------+
```
